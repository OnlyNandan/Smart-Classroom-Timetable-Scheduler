{% extends "base.html" %}

{% block title %}Analytics{% endblock %}
{% block header %}Analytics Dashboard{% endblock %}

{% block content %}
<div class="container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Room Utilization -->
    <div class="glass-card p-6 rounded-2xl shadow-lg">
        <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white">Room Utilization (%)</h3>
        <canvas id="roomUtilizationChart"></canvas>
    </div>

    <!-- Faculty Workload -->
    <div class="glass-card p-6 rounded-2xl shadow-lg">
        <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white">Faculty Workload (Hours/Week)</h3>
        <canvas id="facultyWorkloadChart"></canvas>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const isDark = document.documentElement.classList.contains('dark');
    const textColor = isDark ? 'rgba(229, 231, 235, 0.8)' : 'rgba(55, 65, 81, 1)';
    const gridColor = isDark ? 'rgba(75, 85, 99, 0.5)' : 'rgba(209, 213, 219, 0.5)';
    
    // Room Utilization Chart
    const roomCtx = document.getElementById('roomUtilizationChart').getContext('2d');
    const roomData = {{ room_utilization | tojson }};
    new Chart(roomCtx, {
        type: 'bar',
        data: {
            labels: Object.keys(roomData),
            datasets: [{
                label: 'Utilization %',
                data: Object.values(roomData),
                backgroundColor: 'rgba(168, 85, 247, 0.6)',
                borderColor: 'rgba(147, 51, 234, 1)',
                borderWidth: 1,
                borderRadius: 5
            }]
        },
        options: {
            scales: { y: { beginAtZero: true, max: 100, ticks: { color: textColor }, grid: { color: gridColor } }, x: { ticks: { color: textColor }, grid: { display: false } } },
            plugins: { legend: { labels: { color: textColor } } }
        }
    });

    // Faculty Workload Chart
    const facultyCtx = document.getElementById('facultyWorkloadChart').getContext('2d');
    const facultyData = {{ faculty_workload | tojson }};
    new Chart(facultyCtx, {
        type: 'line',
        data: {
            labels: Object.keys(facultyData),
            datasets: [{
                label: 'Workload (Hours)',
                data: Object.values(facultyData),
                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                borderColor: 'rgba(5, 150, 105, 1)',
                borderWidth: 2,
                tension: 0.3,
                fill: true,
                pointBackgroundColor: 'rgba(5, 150, 105, 1)'
            }]
        },
        options: {
             scales: { y: { beginAtZero: true, ticks: { color: textColor }, grid: { color: gridColor } }, x: { ticks: { color: textColor }, grid: { display: false } } },
            plugins: { legend: { labels: { color: textColor } } }
        }
    });
});
</script>
{% endblock %}

